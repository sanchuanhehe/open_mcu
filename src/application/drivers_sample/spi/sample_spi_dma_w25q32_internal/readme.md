# 对接flash芯片w25q32，通过SPI的DMA方式写入和读取w25q32芯片中的数据
## 关键字: SPI, DMA, w25q32芯片

**【功能描述】**
+ 示例代码基于HAL接口完成时钟、SPI控制器初始化和功能配置。SPI对接flash芯片w25q32，对w25q32芯片进行写入120个数据，之后从芯片中再读出120字节数据，数据的搬运由DMA方式完成。

**【示例配置】**
+ 在"SystemInit()”接口中配置SPI时钟极性、时钟相位、帧格式等参数和DMA通道相关参数，需根据对接的芯片进行相关参数配置。

+ w25q32芯片扇区擦除：调用“SectorErase()”接口先对w25q32芯片进行擦写操作，内部调用接口“SPI_W25Q32_WriteEnable()”向w25q32发送写使能命令，之后发送擦写扇区命令。命令的发送都是调用“HAL_SPI_WriteDMA()”接口。

+ 向w25q32芯片写数据：调用“WritePage()”接口进行数据写入，发送页写入命令和需要写入120个数据，调用“HAL_SPI_WriteDMA()”接口。

+ 从w25q32芯片读数据：调用“ReadData()”接口进行读数据，发送读命令，调用“HAL_SPI_WriteReadDMA()”接口从芯片读取120个数据。

**【示例效果】**
+ 当用户烧录编译后的示例代码后，初始化和配置完成后。当每次DMA搬运完成会进入回调函数打印log，串口打印写入的120个数据和读取的120个数据，如果写入和读取的数据是相同则打印data correct，否则打印data err。

**【注意事项】**
+ 使用此示例代码必须外接flash芯片w25q32。
+ 此示例init文件夹下的工程初始化配置是基于3065HRPIRZ芯片工程生成的。
+ 不通过IDE创建生成场景：初始化配置请参考sample下的init文件内容。
+ 通过IDE创建生成场景：初始化配置请参考user/generatecode下的文件内容。