# 配置I2C作为从机以中断方式进行数据的接收、发送，通过Debug串口打印数据收发的结果
## 关键字: I2C，从机，数据读取，数据发送，中断方式

**【功能描述】**
+ 示例代码基于HAL接口完成时钟、I2C控制器初始化和功能配置。通过中断方式与I2C主机进行数据的接收和数据的发送，通过Debug串口打印数据收发成功或失败的信息。

**【示例配置】**
+ I2C控制器选择：可选择I2C0或I2C1作为从机实现与I2C主机的数据接收和发送。

+ I2C初始化：调用接口"HAL_I2C_Init()”完成对示例代码中I2C的基地址、主从模式、寻址模式（7bit寻址或10bit寻址）、自身地址、接收水线和发送水线、通讯速率等参数进行配置。调用"HAL_I2C_RegisterCallback()"接口注册中断回调函数，并使能相关中断配置。

+ 操作I2C与主机进行数据的发送和接收：<br>
      1. 示例代码中首先循环等待I2C主机发送一个"0x3A"的开始标志帧，当接收到此帧后进入与I2C主机的数据发送和接收的交互；<br> 
      2. 调用"HAL_I2C_SlaveWriteIT()"接口以中断方式向I2C主机发送数据；<br>
      3. 调用"HAL_I2C_SlaveReadIT()"接口以中断方式实现从I2C主机接收数据；<br>
      4. 比较步骤2和步骤3发送和接收的数据是否一致，如果接收和发送的数据一致，则Debug串口打印"I2C Data Success"信息，不一致时打印错误信息。

**【示例效果】**
+ 当用户烧录编译后的示例代码后，初始化和配置完成后，示例代码中会通过I2C以中断方式与主机进行数据的接收和发送，Debug串口打印I2C与主机进行通信交互的结果信息，当发送和接收的数据一致时Debug串口打印"I2C Data Success"；当接收和发送的数据不一致时Debug串口打印错误信息。

**【注意事项】**
+ 示例代码使用UART0进行结果打印输出，需要对UART0配置。
+ 示例代码中I2C必须必须对接主机，且保证主机寻址的地址为82（7bit地址），否则示例代码无法正常运行。

+ 此示例init文件夹下的工程初始化配置是基于3061MNPICA芯片工程生成的。
+ 不通过IDE创建生成场景：初始化配置请参考sample下的init文件内容。
+ 通过IDE创建生成场景：初始化配置请参考user/generatecode下的文件内容。