# MCU芯片 OTA Overwrite Upgrade（覆盖升级）参考示例
## 关键字: OTA，Overwrite，升级

**【功能描述】**
+ OTA是一种通过无线通信实现远程更新设备固件的方法。MCU OTA为通过外部具有无线通信的器件接收新固件数据，外部器件将新固件数据通过MCU串行通信接口发送给MCU，实现固件更新。MCU的OTA主要工作是将串行通信接口接收的新固件数据更新到用户指定的程序区，完成固件的升级。
+ OTA的覆盖升级包括1个user bootloader flash分区、1个APP运行flash分区、1个参数存储flash区。user bootloader flash分区具有判断跳转、升级功能。APP运行flash分区仅用于执行用户逻辑代码。参数存储flash区用于存储升级相关配置参数。
+ flash空间使用：
   1.bootloader flash分区：起始地址0x3000000，大小40K;
   2.APP flash分区：起始地址0x300A000， 大小471K;
   3.参数存储flash分区：起始地址0x301FC00，大小1K;

**【示例配置】**
+ 配置UART0波特率为115200作为升级速率。

+ 配置CRC使用16bit校验结果，用于校验通信数据正确性。

+ 配置flash阻塞方式进行擦除、编写，用于更新flash存储固件。


**【示例效果】**
+ 当用户复位芯片后，MCU首先会执行OTA升级程序，主机在1s内发起与OTA程序握手，握手成功进入固件升级阶段，完成固件升级后，主机下发命令复位MCU。MCU再次重新运行时主机不发起与OTA握手，等待1s后bootloader跳转APP运行地址执行新的程序。

**【注意事项】**
+ 示例代码使用UART0作为升级通道，需要硬件预留UART0的升级管脚。
+ 升级模型需开启中断服务函数基地址不锁定宏，保证APP中断正常执行。
+ 此示例init文件夹下的工程初始化配置是基于3066MNPINH芯片工程生成的。
+ 不通过IDE创建生成场景：初始化配置请参考sample下的init文件内容。
+ 通过IDE创建生成场景：初始化配置请参考user/generatecode下的文件内容。